<!doctype html><html lang="no"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Annonse • GA-13</title>
<link rel="stylesheet" href="/style.css">
</head><body>
<header class="site-header"><div class="wrap">
  <h1 id="ttl">Annonse</h1>
  <nav class="main-nav"><a href="/market.html">Tilbake</a></nav>
</div></header>

<main class="wrap">
  <article class="card" id="view"></article>
  <section class="card">
    <h3>Betaling (stub)</h3>
    <p>Stripe/Vipps kobles på her senere.</p>
    <div style="display:flex; gap:8px; flex-wrap:wrap">
      <button class="btn" onclick="alert('Stripe stub')">Betal med kort</button>
      <button class="btn" style="background:#ff5b24" onclick="alert('Vipps stub')">Betal med Vipps</button>
    </div>
  </section>
</main>

<script>
const params = new URLSearchParams(location.search);
const id = params.get('id');
const view = document.getElementById('view');
const ttl = document.getElementById('ttl');

function formatCurrency(n){try{return new Intl.NumberFormat('no-NO',{style:'currency',currency:'NOK'}).format(n)}catch{return n+' kr'}}

async function run(){
  if(!id){ view.innerHTML='<p>Mangler id.</p>'; return; }
  const res = await fetch('/api/ads/'+id);
  if(!res.ok){ view.innerHTML='<p>Finner ikke annonsen.</p>'; return; }
  const a = await res.json();
  ttl.textContent = a.title;

  view.innerHTML = `
    <img src="${a.imageUrl}" alt="" style="width:100%;max-height:360px;object-fit:cover;border-radius:12px">
    <h2 style="margin:10px 0 4px">${a.title}</h2>
    <div class="muted">${a.category} • ${a.location || ''}</div>
    <p style="margin:12px 0">${a.description || ''}</p>
    <strong style="font-size:1.25rem">${formatCurrency(a.price)}</strong>
    <div class="muted" style="margin-top:8px">Kontakt: ${a.owner || 'ukjent'}</div>
    <div class="muted">Publisert: ${new Date(a.createdAt).toLocaleString()}</div>